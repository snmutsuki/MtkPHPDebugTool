<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Mtk Debug</title>
<style type="text/css">
*{margin:0px;padding:0px;border:none;}
.clearfix{zoom:1;}
	.clearfix:after{
		content:".";
		display:block;
		height:0;
		visibility:hidden;
		clear:both;}
html{height:100%;width:100%;}
body{font:14px/1.25 Arial,"Hiragino Sans GB", "微软雅黑", "新宋体", serif;height:100%;width:100%;}
p{font-size:16px;line-height:20px;margin-top:20px;}
</style>
</head>

<body>

	<div style="height:100%;width:100%;background-color:#eeeeee;">
		<div id="sidebar" style="height:100%;width:20%;float: left;background-color:#dddddd;padding:0 10px;">
			<p><a href="javascript:getDebugLog()">get debug log</a></p>
			<p><a href="javascript:clearAll()">clear all</a></p>
			<p><a href="javascript:showChangedFiles()">show changed files</a></p>
			<p><a href="javascript:removeAllTag()">remove all debug tag</a></p>
		</div>
		<div id="debug_div" style="padding:0 10px;overflow: auto;height:100%;width:77%;display: inline-block;">
		</div>	
	</div>

<script src="http://mutsuki.cn:8080/SpringWebPro/Resource/js/jquery.min.js"></script>
<script src="https://cdn.staticfile.org/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
<script type="text/javascript">

	function getDebug(){
		if(!mode) return;
		fetch("http://localhost:8088/mtkDebug/mtk.php/readDebug").then(response => response.text()).then(text=> $("#debug_div").html(text)).catch(error => alert(error));
	}

	function getDebugLog(){
		mode = 1;
		getDebug();		
	}

	function clearAll(){
		fetch("http://localhost:8088/mtkDebug/mtk.php/refreshDebug").then(response => $("#debug_div").html("")).catch(error => alert(error));		
	}

	function showChangedFiles(){
		mode = 0;
		fetch("http://localhost:8088/mtkDebug/mtk.php/showChangedFiles").then(response => response.text()).then(text => $("#debug_div").html(text)).catch(error => alert(error));
	}

	function removeAllTag(){
		fetch("http://localhost:8088/mtkDebug/mtk.php/removeDebugTag").then(response => void(0)).catch(error => alert(error));
	}

	var timer=null;
	var timer=null;
	var mode = 0;
	window.onload=function(){
		getDebugLog();
		timer = setInterval(getDebug,10000);
	}

	
</script>

</body>
</html>